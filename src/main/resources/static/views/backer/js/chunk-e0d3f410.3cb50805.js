(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e0d3f410"],{1995:function(t,e,a){"use strict";var s=a("e4df"),i=a.n(s);i.a},e4df:function(t,e,a){},eb10:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"top"},[a("div"),a("a-button",{attrs:{type:"primary",shape:"circle",icon:"plus"},on:{click:function(e){t.drawerShow=!0}}},[t._v("添加")])],1),a("a-table",{attrs:{columns:t.columns,rowKey:function(t){return t.id},dataSource:t.tableData,pagination:t.pagination,loading:t.loading,bordered:""},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"operation",fn:function(e,s){return[a("a-switch",{attrs:{checked:0===s.status,checkedChildren:"正常",unCheckedChildren:"锁定"},on:{change:function(e){return t.stateUpdate(s,e)}}}),a("a-button",{staticStyle:{margin:"0 6px"},attrs:{type:"primary",size:"small"},on:{click:function(e){return t.showDrawer(s)}}},[t._v("查看")]),a("a-button",{staticStyle:{margin:"0 6px"},attrs:{type:"primary",size:"small"},on:{click:function(e){return t.showAccess(s)}}},[t._v("权限")]),a("a-popconfirm",{attrs:{title:"确定删除？",cancelText:"取消",okText:"确认"},on:{confirm:function(e){return t.remove(s)}}},[a("a-icon",{staticStyle:{color:"red"},attrs:{slot:"icon",type:"question-circle-o"},slot:"icon"}),a("a-button",{attrs:{type:"danger",size:"small"}},[t._v("删除")])],1)]}}])}),a("a-drawer",{attrs:{title:"角色信息",width:720,visible:t.drawerShow,wrapClassName:"drawer-cont",destroyOnClose:""},on:{close:function(){return t.drawerShow=!1}}},[a("a-form",{attrs:{form:t.form},on:{submit:t.handleSubmit}},[a("a-row",{attrs:{gutter:16}},[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"角色名"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["id"],expression:"['id']"}],attrs:{type:"hidden"}}),a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name"],expression:"['name']"}]})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"角色键值"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["role_key"],expression:"['role_key']"}]})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"角色状态"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["status"],expression:"['status']"}]},[a("a-select-option",{attrs:{value:0}},[t._v("正常")]),a("a-select-option",{attrs:{value:1}},[t._v("锁定")])],1)],1)],1)],1),a("div",{staticClass:"drawer-footer"},[a("a-button",{style:{marginRight:"8px"},on:{click:function(){return t.drawerShow=!1}}},[t._v("取消")]),a("a-button",{attrs:{type:"primary","html-type":"submit"}},[t._v("保存")])],1)],1)],1),a("a-drawer",{attrs:{title:"角色权限",width:720,visible:t.drawerAccessShow,wrapClassName:"drawer-cont",destroyOnClose:""},on:{close:function(){return t.drawerAccessShow=!1}}},[t._l(t.accessList,function(e,s){return a("div",{key:s,staticClass:"menu-m"},[a("a-checkbox-group",{attrs:{options:[{label:e.name,value:e.id}]},model:{value:t.checkedList.permission_ids,callback:function(e){t.$set(t.checkedList,"permission_ids",e)},expression:"checkedList.permission_ids"}}),t._l(e.child,function(e,i){return a("a-row",{key:s+i,staticClass:"menu-r",attrs:{type:"flex",justify:"start",gutter:16}},[a("a-col",{attrs:{span:1}}),a("a-col",{attrs:{span:5}},[a("a-checkbox-group",{attrs:{options:[{label:e.name,value:e.id}]},model:{value:t.checkedList.permission_ids,callback:function(e){t.$set(t.checkedList,"permission_ids",e)},expression:"checkedList.permission_ids"}})],1),a("a-col",{attrs:{span:17}},t._l(e.child,function(e,r){return a("a-checkbox-group",{key:s+i+r,staticClass:"menu-c",attrs:{options:[{label:e.name,value:e.id}]},model:{value:t.checkedList.permission_ids,callback:function(e){t.$set(t.checkedList,"permission_ids",e)},expression:"checkedList.permission_ids"}})}),1)],1)})],2)}),a("div",{staticClass:"drawer-footer"},[a("a-button",{style:{marginRight:"8px"},on:{click:function(){return t.drawerAccessShow=!1}}},[t._v("取消")]),a("a-button",{attrs:{type:"primary"},on:{click:t.submitAccess}},[t._v("保存")])],1)],2)],1)},i=[],r=a("cebc"),n={name:"roles",data:function(){return{columns:[{title:"编号",dataIndex:"id"},{title:"角色",dataIndex:"name"},{title:"角色键值",dataIndex:"role_key"},{title:"操作",dataIndex:"operation",width:"260px",scopedSlots:{customRender:"operation"}}],tableData:[],pagination:{},loading:!1,drawerShow:!1,form:this.$form.createForm(this),checkedList:{role_id:"",permission_ids:[]},accessList:[],drawerAccessShow:!1}},methods:{handleSubmit:function(t){var e=this;t.preventDefault(),this.form.validateFields(function(t,a){t||(void 0===a.id&&delete a.id,e.$ajax({url:a.id?"role/updateRole":"role/addRole",data:a}).then(function(t){1===t.data.code&&(e.$message.success(t.data.msg),e.fetch(e.pagination),e.drawerShow=!1)}))})},submitAccess:function(){var t=this;this.$ajax({url:"role/addOrUpdatePermsForRole",data:this.checkedList}).then(function(e){1===e.data.code&&(t.$message.success(e.data.msg),t.drawerAccessShow=!1)})},showDrawer:function(t){var e=this;this.drawerShow=!0,this.$nextTick(function(){e.form.setFieldsValue(t)})},showAccess:function(t){var e=this;this.drawerAccessShow=!0,this.checkedList.role_id=t.id,this.$ajax({url:"role/selectPermsByRoleId",data:{role_id:t.id}}).then(function(t){e.checkedList.permission_ids=t.data.data})},handleTableChange:function(t,e,a){var s=Object(r["a"])({},this.pagination);s.current=t.current,this.pagination=s,this.fetch(Object(r["a"])({limit:t.pageSize,page:t.current},e))},fetch:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.page=e.page||e.current||1,e.limit=e.limit||10,this.loading=!0,this.$ajax({url:"role/listRole",data:Object(r["a"])({},e)}).then(function(e){var a=Object(r["a"])({},t.pagination);a.total=e.data.count,t.loading=!1,t.tableData=e.data.data,t.pagination=a})},remove:function(t){var e=this;this.$ajax({url:"role/deleteRole",data:{id:t.id}}).then(function(t){1===t.data.code&&(e.$message.success(t.data.msg),e.fetch(e.pagination))})},getAccessList:function(){var t=this;this.$ajax({url:"perms/selectPermsTreeData",data:{page:1,limit:10}}).then(function(e){1===e.data.code&&(t.accessList=e.data.data)})},stateUpdate:function(t,e){var a=this;this.$ajax({url:"role/updateRole",data:{id:t.id,status:0===t.status?1:0}}).then(function(t){1===t.data.code&&(a.$message.success(t.data.msg),a.fetch(a.pagination))})}},mounted:function(){this.getAccessList(),this.fetch()}},o=n,c=(a("1995"),a("2877")),d=Object(c["a"])(o,s,i,!1,null,"0c34b402",null);e["default"]=d.exports}}]);