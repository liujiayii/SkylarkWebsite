<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.websit.mapper.T_adminMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.websit.entity.T_admin">
        <id column="id" property="id" />
        <result column="name" property="name" />
        <result column="phone" property="phone" />
        <result column="username" property="username" />
        <result column="password" property="password" />
        <result column="post" property="post" />
        <result column="status" property="status" />
        <result column="create_time" property="create_time" />
    </resultMap>
    <select id="selectbyName" resultType="com.websit.entity.T_admin">
    
     select * from t_admin where username=#{username}   
    
    </select>

   <select id="selectby" resultType="Integer" >
    
     select count(id) from t_admin where username=#{username} and password=#{password}  
    
    </select>
    
    <!-- 查询管理员账户 -->
   	<select id="findAdminList" resultType="com.websit.entity.T_admin">
		select * from t_admin   	    
   	</select>
   
   	<!-- 通过用户登录名称查询用户信息 -->
	<resultMap id="findByUserName" type="com.websit.entity.T_admin" extends="BaseResultMap">
        <!-- 角色集合 -->
        <collection property="roles" ofType="com.websit.entity.T_role">
            <id column="r_id" property="id" />
        	<result column="r_name" property="name" />
        	<result column="description" property="description" />
        	<result column="r_status" property="status" />
        	<result column="role_key" property="role_key" />
        </collection>
    </resultMap>
	<select id="findByUserName"  resultMap="findByUserName">
        select u.*
        ,r.id as r_id, r.name as r_name, r.description, r.status r_status, r.role_key
        from t_admin u
        LEFT JOIN t_role_admin ur on u.id= ur.admin_id
        LEFT JOIN t_role r on ur.role_id=r.id
        where username= #{username}
    </select>
   
</mapper>
