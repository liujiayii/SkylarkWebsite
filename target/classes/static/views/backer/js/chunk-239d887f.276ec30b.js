(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-239d887f"],{c945:function(t,a,e){},dc13:function(t,a,e){"use strict";var o=e("c945"),r=e.n(o);r.a},ff66:function(t,a,e){"use strict";e.r(a);var o=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"top"},[e("Input",{staticStyle:{width:"300px"},attrs:{search:"",placeholder:"Enter something..."}}),e("Button",{attrs:{type:"primary",shape:"circle",icon:"md-add"},on:{click:function(a){t.drawerShow=!0}}},[t._v("\n      添加\n    ")])],1),e("Table",{attrs:{border:"",columns:t.columns,data:t.tableData.data},scopedSlots:t._u([{key:"action",fn:function(a){var o=a.row;return[e("iSwitch",{staticStyle:{"margin-right":"5px"},attrs:{value:o.state,size:"large","true-value":1,"false-value":2},on:{"on-change":function(a){return t.stateUpdate(o)}}},[e("span",{attrs:{slot:"open"},slot:"open"},[t._v("上架")]),e("span",{attrs:{slot:"close"},slot:"close"},[t._v("下架")])]),e("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary",size:"small"},on:{click:function(a){return t.show(o)}}},[t._v("\n        查看\n      ")])]}}])}),e("div",{staticClass:"page-box"},[e("Page",{attrs:{total:t.tableData.count,size:"small","show-elevator":"","show-total":""},on:{"on-change":t.pageChange}})],1),e("Drawer",{attrs:{title:"编辑",width:"720","mask-closable":!1,styles:t.styles},on:{"on-close":t.clearDrawer},model:{value:t.drawerShow,callback:function(a){t.drawerShow=a},expression:"drawerShow"}},[e("Form",{ref:"formData",attrs:{model:t.formData,rules:t.ruleValidate}},[e("Row",{attrs:{gutter:32}},[e("Col",{attrs:{span:"12"}},[e("FormItem",{attrs:{label:"商品专区"}},[e("Select",{attrs:{size:"large"},model:{value:t.formData.zoneid,callback:function(a){t.$set(t.formData,"zoneid",a)},expression:"formData.zoneid"}},t._l(t.zoneList,function(a,o){return e("Option",{key:o,attrs:{value:a.id}},[t._v("\n                "+t._s(a.name)+"\n              ")])}),1)],1)],1),e("Col",{attrs:{span:"12"}},[e("FormItem",{attrs:{label:"满减优惠"}},[e("Select",{attrs:{size:"large"},model:{value:t.formData.id,callback:function(a){t.$set(t.formData,"id",a)},expression:"formData.id"}},t._l(t.discountList,function(a,o){return e("Option",{key:o,attrs:{value:a.id}},[t._v("\n                满"+t._s(a.price)+"减"+t._s(a.money)+"\n              ")])}),1)],1)],1),e("Col",{attrs:{span:"12"}},[e("FormItem",{attrs:{label:"商品二级分类"}},[e("Select",{attrs:{size:"large"},model:{value:t.formData.producttypeid,callback:function(a){t.$set(t.formData,"producttypeid",a)},expression:"formData.producttypeid"}},t._l(t.sortList,function(a,o){return e("Option",{key:o,attrs:{value:a.id}},[t._v("\n                "+t._s(a.name)+"\n              ")])}),1)],1)],1),e("Col",{attrs:{span:"12"}},[e("FormItem",{attrs:{label:"品牌",prop:"brand"}},[e("Input",{attrs:{size:"large"},model:{value:t.formData.brand,callback:function(a){t.$set(t.formData,"brand",a)},expression:"formData.brand"}})],1)],1),e("Col",{attrs:{span:"12"}},[e("FormItem",{attrs:{label:"商品名称",prop:"productName"}},[e("Input",{attrs:{size:"large"},model:{value:t.formData.productName,callback:function(a){t.$set(t.formData,"productName",a)},expression:"formData.productName"}})],1)],1),e("Col",{attrs:{span:"12"}},[e("FormItem",{attrs:{label:"商品价格",prop:"price"}},[e("Input",{attrs:{size:"large",type:"number"},model:{value:t.formData.price,callback:function(a){t.$set(t.formData,"price",a)},expression:"formData.price"}})],1)],1),e("Col",{attrs:{span:"12"}},[e("FormItem",{attrs:{label:"规格"}},[e("Input",{attrs:{size:"large"},model:{value:t.formData.specifications,callback:function(a){t.$set(t.formData,"specifications",a)},expression:"formData.specifications"}})],1)],1),e("Col",{attrs:{span:"12"}},[e("FormItem",{attrs:{label:"颜色"}},[e("Input",{attrs:{size:"large"},model:{value:t.formData.color,callback:function(a){t.$set(t.formData,"color",a)},expression:"formData.color"}})],1)],1),t.formData.productId?t._e():e("Col",{attrs:{span:"12"}},[e("FormItem",{attrs:{label:"库存",prop:"number"}},[e("Input",{attrs:{size:"large",type:"number"},model:{value:t.formData.number,callback:function(a){t.$set(t.formData,"number",a)},expression:"formData.number"}})],1)],1),e("Col",{attrs:{span:"12"}},[e("FormItem",{attrs:{label:"商品描述",prop:"describion"}},[e("Input",{attrs:{type:"textarea",size:"large"},model:{value:t.formData.describion,callback:function(a){t.$set(t.formData,"describion",a)},expression:"formData.describion"}})],1)],1)],1),e("Upload",{attrs:{action:"/upload","on-success":t.handleUpload,format:["jpg","jpeg","png"],"on-format-error":t.formatError}},[e("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[t._v("\n          上传商品小图\n        ")])],1),e("div",{staticClass:"img-cont"},[e("div",{staticClass:"img-box"},[e("img",{attrs:{src:t.formData.image,alt:""}})])]),e("Upload",{attrs:{action:"/addImg",multiple:"","on-success":t.handleUploadSec,format:["jpg","jpeg","png"],"on-format-error":t.formatError}},[e("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[t._v("\n          上传商品详情图\n        ")])],1),e("div",{staticClass:"img-cont"},t._l(t.fileList,function(a,o){return e("div",{key:o,staticClass:"img-box",on:{click:function(a){return t.delImg(o)}}},[e("div",{staticClass:"ico"},[e("Icon",{attrs:{type:"md-trash"}})],1),e("img",{attrs:{src:a,alt:""}})])}),0)],1),e("div",{staticClass:"demo-drawer-footer"},[e("Button",{attrs:{type:"primary"},on:{click:function(a){return t.submit("formData")}}},[t._v("保存")])],1)],1)],1)},r=[],i=(e("7f7f"),e("d930")),s={name:"Ware",data:function(){return{drawerShow:!1,styles:{height:"calc(100% - 55px)",overflow:"auto",paddingBottom:"53px",position:"static"},formData:{zoneid:0},ruleValidate:i["c"],columns:[{title:"编号",key:"id"},{title:"商品名称",key:"productName"},{title:"商品类型",key:"producttypename"},{title:"价格(元)",key:"price"},{title:"操作",slot:"action",width:200,align:"center"}],tableData:{data:[],count:0},fileList:[],sortList:[],discountList:[],zoneList:[],currPage:1}},methods:{formatError:function(){this.$Notice.error({title:"文件格式错误"})},delImg:function(t){var a=this;this.$Modal.confirm({title:"提示",content:"<p>是否删除</p>",onOk:function(){a.formData.productImage[t].id&&a.$ajax({method:"post",url:"deleteImg",data:{id:a.formData.productImage[t].id}}).then(function(t){1!==t.data.code&&a.$Notice.error({title:t.data.msg})}).catch(function(t){a.$Notice.error({title:t.data.msg})}),a.fileList.splice(t,1),a.$Message.info("Clicked ok")},onCancel:function(){a.$Message.info("Clicked cancel")}})},clearDrawer:function(){this.formData={zoneid:-1},this.fileList=[]},handleUpload:function(t){this.formData.image=t.data},handleUploadSec:function(t){this.fileList.push(t.data[0])},show:function(t){var a=this;this.$ajax({method:"post",url:"listProductByProductId",data:{productId:t.id}}).then(function(e){1===e.data.code?a.$ajax({method:"post",url:"selectZoneByProductId",data:{productaid:t.id}}).then(function(t){1===t.data.code?(e.data.data[0].zoneid=t.data.data[0].id||"",a.formData=e.data.data[0]):a.$Notice.error({title:t.data.msg})}).catch(function(t){a.$Notice.error({title:t.data.msg})}):a.$Notice.error({title:e.data.msg})}).catch(function(t){a.$Notice.error({title:t.data.msg})}),this.$ajax({method:"post",url:"selectProductImageByProductId",data:{productId:t.id}}).then(function(t){if(1===t.data.code)for(var e=0;e<t.data.data.length;e++)a.fileList.push(t.data.data[e].img);else a.$Notice.error({title:t.data.msg})}).catch(function(t){a.$Notice.error({title:t.data.msg})}),this.drawerShow=!0},pageChange:function(t){var a=this;this.currPage=t,this.$ajax({method:"post",url:"listAllProductById",data:{page:t,limit:10}}).then(function(t){1===t.data.code?a.tableData=t.data:a.$Notice.error({title:t.data.msg})}).catch(function(t){a.$Notice.error({title:t.data.msg})})},stateUpdate:function(t){var a=this;this.$ajax({method:"post",url:"updateProductState",data:{id:t.id,state:1==t.state?2:1}}).then(function(e){1===e.data.code?(t.state=1==t.state?2:1,a.$Notice.success({title:e.data.msg})):a.$Notice.error({title:e.data.msg})}).catch(function(t){a.$Notice.error({title:t.data.msg})})},submit:function(t){var a=this;this.$refs[t].validate(function(t){t?(delete a.formData._index,delete a.formData._rowKey,delete a.formData.page,delete a.formData.limit,delete a.formData.productImage,delete a.formData.create_times,a.formData["file"]=a.fileList,a.$ajax({method:"post",url:a.formData.productId?"updateProduct":"saveProduct",data:a.formData}).then(function(t){1===t.data.code?(a.$Notice.success({title:t.data.msg}),a.drawerShow=!1,a.pageChange(a.currPage),a.fileList=[],a.clearDrawer()):a.$Notice.error({title:t.data.msg})}).catch(function(t){a.$Notice.error({title:t.data.msg})})):a.$Message.error("Fail!")})},getClass:function(){var t=this;this.$ajax({method:"post",url:"selectAllProductTypeList",data:{page:1,limit:100}}).then(function(a){1===a.data.code?t.sortList=a.data.data:t.$Notice.error({title:a.data.msg})}).catch(function(a){t.$Notice.error({title:a.data.msg})})},getDiscount:function(){var t=this;this.$ajax({method:"post",url:"pageOfDiscount",data:{page:1,limit:100}}).then(function(a){1===a.data.code?t.discountList=a.data.data:t.$Notice.error({title:a.data.msg})}).catch(function(a){t.$Notice.error({title:a.data.msg})})},getZone:function(){var t=this;this.$ajax({method:"post",url:"selectZoneList",data:{page:1,limit:100}}).then(function(a){1===a.data.code?t.zoneList=a.data.data:t.$Notice.error({title:a.data.msg})}).catch(function(a){t.$Notice.error({title:a.data.msg})})}},mounted:function(){this.pageChange(1),this.getClass(),this.getDiscount(),this.getZone()}},n=s,c=(e("dc13"),e("2877")),l=Object(c["a"])(n,o,r,!1,null,"5f64280a",null);a["default"]=l.exports}}]);